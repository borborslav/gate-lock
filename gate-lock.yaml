esphome:
  name: "gate-lock"
  friendly_name: "gate-lock"
  on_boot: 
    then:
      - switch.turn_off: gpio14_switch

esp8266:
  board: esp01_1m

# Enable logging
logger:

# Enable Home Assistant API
api:
  encryption:
    key: "********************************"

ota:
  - platform: esphome
    password: "********************************"

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password

  # Enable fallback hotspot (captive portal) in case wifi connection fails
  ap:
    ssid: "Test1 Fallback Hotspot"
    password: "CaacoEQzKcGq"

web_server:
  port: 80

i2c:
  sda: GPIO4
  scl: GPIO5
  scan: true

display:
  - platform: ssd1306_i2c
    model: "SSD1306 128x64"
    address: 0x3C
    lambda: |-
      it.printf(0, 0, id(font1), "Current: %.2f A", id(pzem_current).state);
      it.printf(0, 12, id(font1), "Loads ON:"); 

font:
  - file: "fonts/arial.ttf"
    id: font1
    size: 12

uart:
  rx_pin: GPIO1
  tx_pin: GPIO2
  baud_rate: 9600

modbus:

sensor:
  - platform: pzemac
    current:
      name: "PZEM-004T Current"
      id: pzem_current
    update_interval: 1s



captive_portal:
    


# Налаштування GPIO виходів через switch
switch:
  - platform: gpio
    pin:
      number: GPIO14
      inverted: true
    id: gpio14_switch
    restore_mode: ALWAYS_ON


# Налаштування скриптів для кнопок
script:
  - id: toggle_gpio14
    then:
      - switch.turn_on: gpio14_switch
      - delay: 1s
      - switch.turn_off: gpio14_switch

# Налаштування кнопок у Home Assistant
button:
  - platform: template
    name: "Open"
    icon: "mdi:toggle-switch"
    on_press:
      - script.execute: toggle_gpio14

